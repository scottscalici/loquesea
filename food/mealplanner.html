<div id="filter-controls">
  <select id="tagFilter" onchange="displayMeals()">
    <option value="all">All Styles</option>
    <option value="Italian">Italian</option>
    <option value="Taco Tuesday">Taco Tuesday</option>
    <option value="Meatless">Meatless</option>
  </select>
</div>

<div id="meal-container" style="display: flex; flex-wrap: wrap; gap: 20px;">
  </div>

<script>
async function displayMeals() {
  const response = await fetch('https://raw.githubusercontent.com/scottscalici/loquesea/main/food/meals.json');
  const meals = await response.json();
  const filter = document.getElementById('tagFilter').value;
  const container = document.getElementById('meal-container');
  
  container.innerHTML = ''; // Clear current view

  meals.forEach(meal => {
    // Check if meal matches the selected tag
    if (filter === 'all' || meal.tags.includes(filter)) {
      const card = document.createElement('div');
      card.className = 'recipe-card';
      card.innerHTML = `
        <h3>${meal.name}</h3>
        <p><strong>Tags:</strong> ${meal.tags.join(', ')}</p>
        <a href="${meal.source.url}" target="_blank">View Video/Link</a>
        <ul>
          ${meal.ingredients.map(ing => `<li>${ing}</li>`).join('')}
        </ul>
        <button onclick="addToCalendar('${meal.id}')">Add to Planner</button>
      `;
      container.appendChild(card);
    }
  });
}
  // This function takes the filtered list of meals you've planned
function generateShoppingList(plannedMeals) {
    const tally = {};

    plannedMeals.forEach(meal => {
        meal.ingredients.forEach(item => {
            // Standardize to lowercase so "Onion" and "onion" match
            const cleanItem = item.trim().toLowerCase();
            
            if (tally[cleanItem]) {
                tally[cleanItem] += 1;
            } else {
                tally[cleanItem] = 1;
            }
        });
    });

    displayList(tally);
}

function displayList(tally) {
    const listContainer = document.getElementById('shopping-list-display');
    listContainer.innerHTML = "<h2>Shopping List</h2>";
    
    const ul = document.createElement('ul');
    for (const [name, qty] of Object.entries(tally)) {
        const li = document.createElement('li');
        // If qty is 1, just show the name. If more, show "x2"
        li.textContent = qty > 1 ? `${name} (x${qty})` : name;
        ul.appendChild(li);
    }
    listContainer.appendChild(ul);
}
</script>
